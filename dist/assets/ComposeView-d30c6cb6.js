import{_ as y,d as O,r as l,o as c,c as w,a as s,w as i,f as r,F as b,b as m,u as D,k as L,g as v,p as S,n as T,t as H,h as R,m as _,x as j}from"./index-a30e8698.js";const B=O({setup(){const e=m([]);e.value.title="",e.value.is_private=!1,e.value.is_recommend=!1;const a=m([]);D();const d=m(!1),p=m(""),{proxy:f}=R();L(()=>{let t=new URLSearchParams;t.append("token",$cookies.get("token")),t.append("timestamp",new Date().getTime()),f.$http.post("/ajax/get_folder_ajax/",t).then(n=>{n.data.code=="401"&&(window.location.href="/login"),a.value=n.data.data.data,e.value.folder_id=n.data.data.data[0].value})});const k=()=>{if(d.value=!0,f.$func.getVarType(p)=="undefined"||p=="")_.info("内容不能为空"),d.value=!1;else{let t=new URLSearchParams;t.append("token",$cookies.get("token")),t.append("timestamp",new Date().getTime()),t.append("content",p.value),t.append("title",e.value.title),t.append("folder_id",e.value.folder_id),e.value.is_private==!0?t.append("is_private",1):t.append("is_private",0),e.value.is_recommend==!0?t.append("is_recommend",1):t.append("is_recommend",0),f.$http.post("/ajax/save_post_ajax/",t).then(n=>{n.data.msg=="新建成功"?(u.value=!0,d.value=!1):(_.info(n.data.msg),d.value=!1)}).catch(n=>{_.info("无法正常保存"),d.value=!1,console.log(n)})}},u=m(!1);return{visible:u,handleOk:t=>{u.value=!1,window.location.href="/user"},formState:e,folder_list:a,valueHtml:p,save:k,iconLoading:d}},created(){this.editorConfig={toolbars:[["source","undo","redo","cleardoc","simpleupload"]],UEDITOR_HOME_URL:"/UEditor/",lang:"zh-cn",initialFrameHeight:360,serverUrl:this.$remoteDomain+"/ueditor/controller.php?token="+$cookies.get("token")+"&timestamp="+new Date().getTime()}}}),E=r("h3",{style:{"margin-top":"15px"}},"写作",-1),N=r("p",null,"跳转到文章列表页请点击“确定”",-1),F=r("p",null,"再写一篇请点击“取消”",-1);function I(e,a,d,p,f,k){const u=l("a-button"),g=l("a-input"),t=l("a-form-item"),n=l("a-select-option"),U=l("a-select"),h=l("a-checkbox"),$=l("a-form"),C=l("vue-ueditor-wrap"),V=l("a-modal");return c(),w(b,null,[E,s(u,{type:"primary",onClick:e.save,loading:e.iconLoading},{default:i(()=>[v("保存")]),_:1},8,["onClick","loading"]),s($,{model:e.formState},{default:i(()=>[s(t,{label:"标题",name:"title"},{default:i(()=>[s(g,{value:e.formState.title,"onUpdate:value":a[0]||(a[0]=o=>e.formState.title=o)},null,8,["value"])]),_:1}),r("p",null,[e.folder_list?(c(),S(U,{key:0,style:{width:"100%"},value:e.formState.folder_id,"onUpdate:value":a[1]||(a[1]=o=>e.formState.folder_id=o)},{default:i(()=>[(c(!0),w(b,null,T(e.folder_list,o=>(c(),S(n,{value:o.value,lv:o.lv},{default:i(()=>[v(j(o.name),1)]),_:2},1032,["value","lv"]))),256))]),_:1},8,["value"])):H("",!0)]),r("p",null,[s(h,{checked:e.formState.is_private,"onUpdate:checked":a[2]||(a[2]=o=>e.formState.is_private=o)},{default:i(()=>[v("私有")]),_:1},8,["checked"]),s(h,{checked:e.formState.is_recommend,"onUpdate:checked":a[3]||(a[3]=o=>e.formState.is_recommend=o)},{default:i(()=>[v("推荐")]),_:1},8,["checked"])])]),_:1},8,["model"]),s(C,{modelValue:e.valueHtml,"onUpdate:modelValue":a[4]||(a[4]=o=>e.valueHtml=o),config:e.editorConfig,"editor-id":"editor-demo-01"},null,8,["modelValue","config"]),r("div",null,[s(V,{visible:e.visible,"onUpdate:visible":a[5]||(a[5]=o=>e.visible=o),title:"新建文章成功",onOk:e.handleOk,"ok-text":"确认","cancel-text":"取消"},{default:i(()=>[N,F]),_:1},8,["visible","onOk"])])],64)}const P=y(B,[["render",I]]);export{P as default};
