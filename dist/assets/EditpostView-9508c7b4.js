import{_ as C,b as p,u as I,h as D,k as R,r,o as v,c as S,l as j,v as E,f as h,a as s,w as c,F as x,m as b,g,p as U,n as L,t as T,q as H,s as B,x as M}from"./index-a30e8698.js";const N={setup(){const t=p([]),n=I(),_=p(!1),e=p([]),m=p(""),{proxy:u}=D(),i=p(10),f=p(!1);return R(()=>{const a=setInterval(()=>{const o=i.value+Math.round(Math.random()*7+2);i.value=o>95?95:o,i.value>90&&clearInterval(a)},100);let d=new URLSearchParams;d.append("token",$cookies.get("token")),d.append("timestamp",new Date().getTime()),d.append("post_id",n.currentRoute.value.params.id),u.$http.post("/ajax/get_folder_ajax/",d).then(o=>{o.data.code=="401"&&(window.location.href="/login"),e.value=o.data.data.data}),u.$http.post("/ajax/get_post_ajax/",d).then(o=>{console.log(o.data.data),m.value=o.data.data.content,i.value=100,f.value=!0,t.value.title=o.data.data.title,t.value.folder_id=o.data.data.folder_id,o.data.data.is_private==1?t.value.is_private=!0:t.value.is_private=!1,o.data.data.is_recommend==1?t.value.is_recommend=!0:t.value.is_recommend=!1}),setTimeout(()=>{},1500)}),{formState:t,valueHtml:m,save:()=>{_.value=!0;let a=new URLSearchParams;a.append("token",$cookies.get("token")),a.append("timestamp",new Date().getTime()),a.append("content",m.value),a.append("title",t.value.title),a.append("folder_id",t.value.folder_id),a.append("post_id",n.currentRoute.value.params.id),t.value.is_private==!0?a.append("is_private",1):a.append("is_private",0),t.value.is_recommend==!0?a.append("is_recommend",1):a.append("is_recommend",0),u.$http.post("/ajax/save_post_ajax/",a).then(d=>{console.log(d),b.info(d.data.msg),_.value=!1}).catch(d=>{b.info("无法正常保存"),_.value=!1,console.log(d)})},folder_list:e,iconLoading:_,defaultPercent:i,loadingdone:f}},created(){this.editorConfig={toolbars:[["source","undo","redo","simpleupload"]],UEDITOR_HOME_URL:"/UEditor/",lang:"zh-cn",initialFrameHeight:360,serverUrl:this.$remoteDomain+"/ueditor/controller.php?token="+$cookies.get("token")+"&timestamp="+new Date().getTime()}}},P=t=>(H("data-v-199f5aab"),t=t(),B(),t),F={class:"loadingbar"},q=P(()=>h("h3",{style:{"margin-top":"15px"}},"编辑文章",-1));function O(t,n,_,e,m,u){const i=r("a-progress"),f=r("a-button"),k=r("a-input"),a=r("a-form-item"),d=r("a-select-option"),o=r("a-select"),w=r("a-checkbox"),y=r("a-form"),V=r("vue-ueditor-wrap");return v(),S(x,null,[j(h("div",F,[s(i,{type:"circle",percent:e.defaultPercent,status:"active","show-info":!1,"stroke-color":{"0%":"#108ee9","100%":"#87d068"}},null,8,["percent"])],512),[[E,e.loadingdone==!1]]),q,s(f,{type:"primary",onClick:e.save,loading:e.iconLoading},{default:c(()=>[g("保存")]),_:1},8,["onClick","loading"]),s(y,{model:e.formState},{default:c(()=>[s(a,{label:"标题",name:"title",rules:[{required:!0,message:"标题不能为空"}]},{default:c(()=>[s(k,{value:e.formState.title,"onUpdate:value":n[0]||(n[0]=l=>e.formState.title=l)},null,8,["value"])]),_:1}),h("p",null,[e.folder_list?(v(),U(o,{key:0,style:{width:"100%"},value:e.formState.folder_id,"onUpdate:value":n[1]||(n[1]=l=>e.formState.folder_id=l)},{default:c(()=>[(v(!0),S(x,null,L(e.folder_list,l=>(v(),U(d,{value:l.value,lv:l.lv},{default:c(()=>[g(M(l.name),1)]),_:2},1032,["value","lv"]))),256))]),_:1},8,["value"])):T("",!0)]),h("p",null,[s(w,{checked:e.formState.is_private,"onUpdate:checked":n[2]||(n[2]=l=>e.formState.is_private=l)},{default:c(()=>[g("私有")]),_:1},8,["checked"]),s(w,{checked:e.formState.is_recommend,"onUpdate:checked":n[3]||(n[3]=l=>e.formState.is_recommend=l)},{default:c(()=>[g("推荐")]),_:1},8,["checked"])])]),_:1},8,["model"]),s(V,{modelValue:e.valueHtml,"onUpdate:modelValue":n[4]||(n[4]=l=>e.valueHtml=l),config:t.editorConfig,"editor-id":"editor-demo-01"},null,8,["modelValue","config"])],64)}const A=C(N,[["render",O],["__scopeId","data-v-199f5aab"]]);export{A as default};
