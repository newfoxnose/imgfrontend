import{a as s,A as q,d as N,g as V,h as z,C as E,S as F,P as R,i as y,m as n,_ as Q,r,o as d,c as h,e as p,F as m,j as g,w as u,f,k as c,l as _,t as T,p as G,n as H}from"./index-dbff6c52.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const W=J;function C(e){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(l).filter(function(o){return Object.getOwnPropertyDescriptor(l,o).enumerable}))),i.forEach(function(o){X(e,o,l[o])})}return e}function X(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var w=function(t,l){var i=C({},t,l.attrs);return s(q,C({},i,{icon:W}),null)};w.displayName="StarOutlined";w.inheritAttrs=!1;const Y=w;$cookies.get("login")!="yes"&&(window.location.href="/login");const Z=N({components:{bookmarkitem:V,subfolder:z,CloseOutlined:E,StarOutlined:Y,SearchOutlined:F,PlusOutlined:R},setup(){const e=y(!1),t=y(String);return{visible:e,showDrawer:o=>{e.value=!0,t.value=o},updatedDrawerTitle:t,onClose:()=>{e.value=!1}}},data(){return{items:{},question:"",search:"",editable:"yes",title:"",url:"",folder_id:"",folder_list:{},clicked:!1,editId:"",new_folder:"",new_folder_clicked:!1,is_private:!1}},watch:{question(e,t){this.search=e}},methods:{fatherMethod(e,t,l,i,o,b){e=="编辑书签"?(this.showDrawer(e),this.editId=t,this.url=l,this.title=i,b==1?this.is_private=!0:this.is_private=!1,o==-1?this.folder_id=this.folder_list[0].value:this.folder_id=o):(this.showDrawer("新建书签"),this.editId="",this.url="",this.title="",this.folder_id=this.folder_list[0].value,this.is_private=!1)},clearQuestion(){this.question="",this.search=""},getUrl(){let e=this.url.toLowerCase();if(e=="")n.info("网址不能为空");else if(e.substring(0,7)!="http://"&&e.substring(0,8)!="https://")n.info("网址必须以http://或https://开头");else if(this.clicked==!1){this.clicked=!0,n.info("自动获取网页标题中，请稍等");let t=new URLSearchParams;t.append("url",e),t.append("teacher_id",$cookies.get("teacher_id")),t.append("login",$cookies.get("login")),t.append("level",$cookies.get("level")),this.$http.post("/ajax/url_title",t).then(l=>{console.log(l.data),l.data.msg=="请求成功"?(n.info("成功获取网页标题"),this.title=l.data.data.title):(n.info("未获取到网页标题，但仍可以直接添加网址"),this.title=l.data.data.title),this.clicked=!1}).catch(l=>{console.log(l),this.clicked=!1})}else n.info("正在请求数据，请勿重复点击")},addBookmark(e,t){if(this.url!=""&&this.title!=""&&this.folder_id!=""){let l=new URLSearchParams;l.append("url",this.url),l.append("title",this.title),l.append("folder_id",this.folder_id),this.is_private==!0?l.append("is_private",1):l.append("is_private",0),l.append("teacher_id",$cookies.get("teacher_id")),l.append("login",$cookies.get("login")),l.append("level",$cookies.get("level"));let i="";e!=""&&t=="删除"?(l.append("id",e),i="/ajax/delete_bookmark_ajax"):e!=""?(l.append("id",e),i="/ajax/edit_bookmark_ajax"):i="/ajax/add_bookmark_ajax",this.$http.post(i,l).then(o=>{console.log(o.data),n.info(o.data.msg),o.data.data!=null&&(window.location.href="/user")}).catch(o=>{console.log(o)})}else n.info("请填写必要项目")},newFolder(){if(this.new_folder=="")n.info("新目录名称不能为空");else if(this.new_folder_clicked==!1){this.new_folder_clicked=!0,n.info("创建新目录中，请稍等");let e=new URLSearchParams;e.append("new_folder",this.new_folder),e.append("folder_id",this.folder_id),e.append("teacher_id",$cookies.get("teacher_id")),e.append("login",$cookies.get("login")),e.append("level",$cookies.get("level")),this.$http.post("/ajax/new_folder_ajax",e).then(t=>{console.log(t.data),t.data.msg=="新建目录成功"?(n.info("新建目录成功"),this.folder_list=t.data.data,this.folder_id=String(t.data.inserted_id)):n.info(t.data.msg),this.new_folder_clicked=!1}).catch(t=>{console.log(t),this.new_folder_clicked=!1})}else n.info("正在请求数据，请勿重复点击")}},async mounted(){let e=new URLSearchParams;e.append("teacher_id",$cookies.get("teacher_id")),e.append("login",$cookies.get("login")),e.append("level",$cookies.get("level"));const{data:t}=await this.$http.post("/ajax/home_ajax/",e);this.items=t.data;const{data:l}=await this.$http.post("/ajax/get_folder_ajax/",e);this.folder_list=l.data.data,this.folder_id=l.data.data[0].value}}),S=e=>(G("data-v-245e544c"),e=e(),H(),e),K=S(()=>p("h3",{style:{"margin-top":"15px"}},"根目录",-1)),x=S(()=>p("div",{style:{"margin-bottom":"20px"}},null,-1)),ee={class:"search-div"},te={class:"search"};function le(e,t,l,i,o,b){const j=r("bookmarkitem"),O=r("subfolder"),U=r("star-outlined"),L=r("close-outlined"),v=r("a-input"),k=r("a-button"),P=r("search-outlined"),$=r("a-spin"),I=r("a-select-option"),B=r("a-select"),D=r("plus-outlined"),M=r("a-checkbox"),A=r("a-drawer");return d(),h(m,null,[K,p("div",null,[(d(!0),h(m,null,g(e.items.root_bookmarks,a=>(d(),c(j,{id:a.id,folder_id:a.folder_id,url:a.url,title:a.title,short_title:a.short_title,is_private:a.is_private,icon:a.icon_display,search:e.search,editable:e.editable,onEditbookmark:e.fatherMethod},null,8,["id","folder_id","url","title","short_title","is_private","icon","search","editable","onEditbookmark"]))),256))]),(d(!0),h(m,null,g(e.items.folder,a=>(d(),h("div",null,[s(O,{folder_name:a.folder_name,folder_bookmark:a.bookmarks,subfolder:a.subfolder,search:e.search,editable:e.editable,fatherMethod:e.fatherMethod},null,8,["folder_name","folder_bookmark","subfolder","search","editable","fatherMethod"])]))),256)),x,p("div",ee,[p("div",te,[s(v,{value:e.question,"onUpdate:value":t[1]||(t[1]=a=>e.question=a)},{addonBefore:u(()=>[s(U,{onClick:t[0]||(t[0]=a=>e.fatherMethod("新建书签"))})]),addonAfter:u(()=>[s(L,{onClick:e.clearQuestion},null,8,["onClick"])]),_:1},8,["value"])])]),s(A,{width:500,title:e.updatedDrawerTitle,placement:"bottom",visible:e.visible,onClose:e.onClose},{extra:u(()=>[s(k,{type:"primary",danger:"",onClick:t[2]||(t[2]=a=>e.addBookmark(e.editId,"删除"))},{default:u(()=>[f("删除")]),_:1})]),default:u(()=>[p("p",null,[s(v,{value:e.url,"onUpdate:value":t[3]||(t[3]=a=>e.url=a),placeholder:"网址"},{addonAfter:u(()=>[e.clicked?_("",!0):(d(),c(P,{key:0,onClick:e.getUrl},null,8,["onClick"])),e.clicked?(d(),c($,{key:1,size:"small"})):_("",!0)]),_:1},8,["value"])]),p("p",null,[s(v,{value:e.title,"onUpdate:value":t[4]||(t[4]=a=>e.title=a),placeholder:"标题"},null,8,["value"])]),p("p",null,[e.folder_list?(d(),c(B,{key:0,style:{width:"100%"},value:e.folder_id,"onUpdate:value":t[5]||(t[5]=a=>e.folder_id=a)},{default:u(()=>[(d(!0),h(m,null,g(e.folder_list,a=>(d(),c(I,{value:a.value,lv:a.lv},{default:u(()=>[f(T(a.name),1)]),_:2},1032,["value","lv"]))),256))]),_:1},8,["value"])):_("",!0)]),p("p",null,[s(v,{value:e.new_folder,"onUpdate:value":t[6]||(t[6]=a=>e.new_folder=a),placeholder:"新目录"},{addonAfter:u(()=>[e.new_folder_clicked?_("",!0):(d(),c(D,{key:0,onClick:e.newFolder},null,8,["onClick"])),e.new_folder_clicked?(d(),c($,{key:1,size:"small"})):_("",!0)]),_:1},8,["value"])]),p("p",null,[s(M,{checked:e.is_private,"onUpdate:checked":t[7]||(t[7]=a=>e.is_private=a)},{default:u(()=>[f("私有")]),_:1},8,["checked"])]),p("p",null,[s(k,{type:"primary",onClick:t[8]||(t[8]=a=>e.addBookmark(e.editId))},{default:u(()=>[f("提交")]),_:1}),f("   "),s(k,{style:{"margin-right":"8px"},onClick:e.onClose},{default:u(()=>[f("取消")]),_:1},8,["onClick"])])]),_:1},8,["title","visible","onClose"])],64)}const ae=Q(Z,[["render",le],["__scopeId","data-v-245e544c"]]),ie={__name:"UserView",setup(e){return(t,l)=>(d(),h("div",null,[s(ae)]))}};export{ie as default};
