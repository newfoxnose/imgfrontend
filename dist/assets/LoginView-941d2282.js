import{j as w,F as _}from"./jquery-0bce2abe.js";import{m as F}from"./md5-9ddf245e.js";import{_ as k,d as j,r as i,o as y,c as S,a as r,w as l,F as U,b as u,e as L,f,g as b,h as C,m as R}from"./index-a30e8698.js";Object.assign(window,{$:w,jQuery:w});const T=j({setup(){const a=u(!1),e=u(""),{proxy:c}=C(),h=L({email:"",password:""}),m=u(!1),g=t=>{console.log("Success:",t)},d=t=>{console.log("Failed:",t)};return _.get(function(t){const o=t.map(function(s,n){return n===0?s.value.replace(/\bNetType\/\w+\b/,""):s.value});e.value=_.x64hash128(o.join(""),31),c.$http.get("/ajax/captcha_ajax/"+e.value,{params:{},responseType:"blob"}).then(s=>{var n=window.URL.createObjectURL(s.data);$("#captchaimg").attr("src",n)})}),{login:t=>{a.value=!0;let o=new URLSearchParams;o.append("email",t.email),o.append("password",F(t.password)),o.append("captcha",t.captcha),o.append("exclusive_login",m.value),o.append("hashkey",e.value),o.append("timestamp",new Date().getTime()),c.$http.post("/ajax/login_ajax/",o).then(s=>{a.value=!1,R.info(s.data.msg),s.data.code=="200"&&($cookies.set("token",s.data.data.token,"720h"),window.location.href="/user")}).catch(s=>{a.value=!1,console.log(s)})},murmur:e,reload_captcha:()=>{c.$http.get("/ajax/captcha_ajax/"+e.value,{params:{},responseType:"blob"}).then(t=>{var o=window.URL.createObjectURL(t.data);$("#captchaimg").attr("src",o)})},formState:h,onFinish:g,iconLoading:a,onFinishFailed:d,checked:m}}}),N=f("div",{style:{"margin-top":"15px"}},null,-1);function V(a,e,c,h,m,g){const d=i("a-input"),p=i("a-form-item"),v=i("a-input-password"),t=i("a-checkbox"),o=i("a-button"),s=i("a-form");return y(),S(U,null,[N,r(s,{model:a.formState,name:"basic","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",onFinish:a.login,onFinishFailed:a.onFinishFailed},{default:l(()=>[r(p,{label:"邮箱",name:"email",rules:[{type:"email",required:!0,message:"请输入有效邮箱地址"}]},{default:l(()=>[r(d,{value:a.formState.email,"onUpdate:value":e[0]||(e[0]=n=>a.formState.email=n)},null,8,["value"])]),_:1}),r(p,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}]},{default:l(()=>[r(v,{value:a.formState.password,"onUpdate:value":e[1]||(e[1]=n=>a.formState.password=n)},null,8,["value"])]),_:1}),r(p,{label:"验证码",name:"captcha",rules:[{required:!0,message:"请输入验证码"}]},{default:l(()=>[r(d,{value:a.formState.captcha,"onUpdate:value":e[3]||(e[3]=n=>a.formState.captcha=n)},{addonAfter:l(()=>[f("div",null,[f("img",{id:"captchaimg",onClick:e[2]||(e[2]=(...n)=>a.reload_captcha&&a.reload_captcha(...n))})])]),_:1},8,["value"])]),_:1}),r(p,{"wrapper-col":{offset:8,span:16}},{default:l(()=>[r(t,{checked:a.checked,"onUpdate:checked":e[4]||(e[4]=n=>a.checked=n)},{default:l(()=>[b("仅在此设备登入")]),_:1},8,["checked"])]),_:1}),r(p,{"wrapper-col":{offset:8,span:16}},{default:l(()=>[r(o,{type:"primary","html-type":"submit",loading:a.iconLoading},{default:l(()=>[b("登入")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","onFinish","onFinishFailed"])],64)}const O=k(T,[["render",V]]);export{O as default};
